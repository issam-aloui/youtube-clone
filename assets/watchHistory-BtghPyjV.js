import{r as f,j as e,S as v,F as g,V as n,B as c,T as l}from"./index-D3w7qsLg.js";import{u as k,a as I,b as P,I as W}from"./formatters-B9676DKi.js";import{S as p,b as x}from"./skeleton-Ripzshjl.js";const E=f.forwardRef(function(o,s){return e.jsx(v,{align:"center",...o,direction:"row",ref:s})}),T=({thumbnail:t,title:o,channelName:s,views:r,uploadDate:a,duration:i,isVerified:m=!1,isLoading:y=!1,onVideoClick:u,onChannelClick:w})=>{const[h,d]=f.useState(!0),b=k(),S=I(),H=P();return y?e.jsxs(g,{w:"100%",minH:{base:"120px",md:"94px"},bg:"gray.50",borderRadius:"12px",overflow:"hidden",gap:{base:2,md:3},p:2,direction:{base:"column",sm:"row"},children:[e.jsx(p,{w:{base:"100%",sm:"168px"},h:{base:"140px",sm:"94px"},borderRadius:"12px",flexShrink:0}),e.jsxs(n,{align:"start",justify:"start",flex:1,spacing:2,pt:1,children:[e.jsx(x,{noOfLines:2,spacing:1,skeletonHeight:"3",w:"90%"}),e.jsx(x,{noOfLines:1,spacing:1,skeletonHeight:"2",w:"60%"})]})]}):e.jsxs(g,{w:"100%",minH:{base:"120px",md:"94px"},cursor:"pointer",borderRadius:"12px",overflow:"hidden",transition:"all 0.2s ease",_hover:{transform:"scale(1.02)"},gap:{base:2,md:3},p:2,direction:{base:"column",sm:"row"},onClick:u,children:[e.jsxs(c,{position:"relative",w:{base:"100%",sm:"168px"},h:{base:"140px",sm:"94px"},borderRadius:"12px",overflow:"hidden",flexShrink:0,bg:"gray.200",children:[e.jsx(W,{src:t,alt:o,w:"100%",h:"100%",objectFit:"cover",onLoad:()=>d(!1),onError:()=>d(!1),style:{display:h?"none":"block"}}),h&&e.jsx(p,{w:"100%",h:"100%",position:"absolute",top:0,left:0}),i&&e.jsx(c,{position:"absolute",bottom:"4px",right:"4px",bg:"rgba(0, 0, 0, 0.8)",color:"white",px:1,py:.5,borderRadius:"4px",fontSize:"xs",fontWeight:"medium",children:S(i)})]}),e.jsxs(n,{align:"start",justify:"start",flex:1,spacing:1,overflow:"hidden",minW:0,children:[e.jsx(l,{fontSize:{base:"16px",md:"14px"},fontWeight:"500",color:"white",lineHeight:"20px",noOfLines:{base:3,md:2},cursor:"pointer",transition:"color 0.2s ease",wordBreak:"break-word",children:o}),e.jsxs(n,{align:"start",spacing:.5,w:"100%",children:[e.jsxs(E,{spacing:1,flexWrap:"wrap",children:[e.jsx(l,{fontSize:{base:"14px",md:"13px"},color:"#aaaaaa",cursor:"pointer",transition:"color 0.2s ease",onClick:j=>{j.stopPropagation(),w?.()},noOfLines:1,children:s}),m&&e.jsx(c,{w:"14px",h:"14px",bg:"gray.500",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"white",flexShrink:0,children:"✓"})]}),e.jsxs(l,{fontSize:{base:"14px",md:"13px"},color:"#aaaaaa",noOfLines:1,wordBreak:"break-word",children:[b(r)," • ",H(a)]})]})]})]})},O=async t=>{try{const o="/youtube-clone/",s=`/data/videos/${t}.json`,r=`${o.slice(0,-1)}${s}`,a=await fetch(r);if(!a.ok)throw new Error(`Failed to fetch video ${t}`);return await a.json()}catch(o){return console.error(`Error fetching video ${t}:`,o),null}},V=t=>{try{if(localStorage.getItem("historyPaused")==="true")return;const s=localStorage.getItem("watchHistory");let r=[];s&&(r=JSON.parse(s));const a={videoId:t,watchedAt:new Date().toISOString()};r=r.filter(i=>i.videoId!==t),r.push(a),r.length>1e3&&(r=r.slice(-1e3)),localStorage.setItem("watchHistory",JSON.stringify(r))}catch(o){console.error("Error adding to watch history:",o)}},D=()=>{try{const t=localStorage.getItem("watchHistory");return t?JSON.parse(t):[]}catch(t){return console.error("Error loading watch history:",t),[]}},z=async()=>{try{const o=D().reverse();return(await Promise.all(o.map(async r=>{const a=await O(r.videoId);return{...r,videoDetails:a}}))).filter(r=>r.videoDetails!==null)}catch(t){return console.error("Error loading watch history with details:",t),[]}},B=()=>{try{localStorage.removeItem("watchHistory")}catch(t){console.error("Error clearing watch history:",t)}},J=(t,o)=>{try{const s=localStorage.getItem("watchHistory");if(s){let r=JSON.parse(s);r=r.filter(a=>!(a.videoId===t&&a.watchedAt===o)),localStorage.setItem("watchHistory",JSON.stringify(r))}}catch(s){console.error("Error removing from watch history:",s)}},N=()=>localStorage.getItem("historyPaused")==="true",$=t=>{localStorage.setItem("historyPaused",t.toString())};export{E as H,T as M,V as a,B as c,z as g,N as i,J as r,$ as s};
