import{r as o,u as H,j as s,B as x,F as R,V as j,T as C,g as W}from"./index-D3w7qsLg.js";import{V as w}from"./VideoCard-CP3Fn8WR.js";import{l as D}from"./videoDataLoader-BZaTkg2Q.js";import{S as T}from"./formatters-B9676DKi.js";import{H as m}from"./heading-BnfipJCG.js";import{S as y}from"./simple-grid-CyA8lx9m.js";import"./skeleton-Ripzshjl.js";function K(){const[V,p]=o.useState(!0),[c,b]=o.useState(!1),[i,d]=o.useState([]),[f,l]=o.useState([]),[E,I]=o.useState([]),[A,L]=o.useState(1),h=o.useRef(null),k=H(),u=10;o.useEffect(()=>{(async()=>{try{p(!0);const t=W();if(I(t),t.length===0){d([]),l([]),p(!1);return}const n=await D();if(n&&Array.isArray(n)){const r=n.map((g,N)=>{const B=Math.floor(Math.random()*t.length),$=t[B];return{...g,channelName:$,id:`sub-${g.id}-${N}`}});d(r);const a=r.slice(0,u);l(a)}else console.error("Invalid data format received"),d([]),l([])}catch(t){console.error("Error fetching subscription videos:",t),d([]),l([])}finally{p(!1)}})()},[]);const M=()=>{c||i.length===0||(b(!0),setTimeout(()=>{const e=A*u;let t=e+u;if(e>=i.length){t=u;const r=i.slice(0,t);l(a=>[...a,...r])}else if(t>i.length){const n=i.slice(e),r=i.slice(0,t-i.length),a=[...n,...r];l(g=>[...g,...a])}else{const n=i.slice(e,t);l(r=>[...r,...n])}L(n=>n+1),b(!1)},1e3))},S=()=>{if(!h.current)return;const{scrollTop:e,scrollHeight:t,clientHeight:n}=h.current;(e+n)/t>.8&&!c&&f.length>0&&M()};o.useEffect(()=>{const e=h.current;if(e)return e.addEventListener("scroll",S),()=>e.removeEventListener("scroll",S)},[c,f.length]);const P=e=>{k(`/watch/${e}`)},v=e=>{console.log(`Clicked on channel: ${e}`)},z=e=>{console.log(`More options for video: ${e}`)};return s.jsx(x,{ref:h,className:"custom-scrollbar",overflowY:"auto",h:"full",w:"full",p:"20px",children:V?s.jsxs(x,{children:[s.jsx(m,{as:"h1",size:"2xl",color:"white",mb:"24px",fontSize:{base:"24px",md:"28px",lg:"36px"},fontWeight:"600",children:"Subscriptions"}),s.jsx(y,{columns:{base:1,sm:1,md:2,lg:3,xl:4},spacing:"20px",gap:4,w:"full",children:Array.from({length:10},(e,t)=>s.jsx(w,{isLoading:!0},`loading-${t}`))})]}):E.length===0?s.jsx(R,{direction:"column",align:"center",justify:"center",h:"60vh",textAlign:"center",children:s.jsxs(j,{spacing:"24px",children:[s.jsx(x,{w:"80px",h:"80px",bg:"gray.700",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",children:s.jsx(C,{fontSize:"32px",color:"gray.400",children:"ðŸ“º"})}),s.jsxs(j,{spacing:"8px",children:[s.jsx(m,{as:"h2",size:"lg",color:"white",fontWeight:"600",children:"No subscriptions yet"}),s.jsx(C,{fontSize:"16px",color:"gray.400",maxW:"400px",lineHeight:"1.5",children:"Start exploring and subscribe to your favorite channels to see their latest videos here."})]})]})}):s.jsxs(x,{children:[s.jsx(m,{as:"h1",size:"2xl",color:"white",mb:"24px",fontSize:{base:"24px",md:"28px",lg:"36px"},fontWeight:"600",children:"Subscriptions"}),s.jsxs(y,{columns:{base:1,sm:1,md:2,lg:3,xl:4},spacing:"20px",gap:4,w:"full",children:[f.map(e=>s.jsx(w,{thumbnail:e.thumbnail,title:e.title,channelName:e.channelName,channelAvatar:e.channelAvatar,views:e.views,uploadDate:e.uploadDate,duration:e.duration,isVerified:e.isVerified,onVideoClick:()=>P(e.id),onChannelClick:()=>v(e.channelName),onMoreClick:()=>z(e.id)},e.id)),c&&s.jsx(T,{gridColumn:"1 / -1",text:"Loading more videos...",textColor:"gray.600"})]})]})})}export{K as default};
