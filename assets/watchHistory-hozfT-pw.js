import{r as f,j as e,S as v,F as g,V as n,B as c,T as l}from"./index-CDy_V-20.js";import{u as k,a as I,b as W,I as E}from"./formatters-1D1gjGA3.js";import{S as p,b as x}from"./skeleton-MgGYAvlR.js";const O=f.forwardRef(function(o,s){return e.jsx(v,{align:"center",...o,direction:"row",ref:s})}),T=({thumbnail:r,title:o,channelName:s,views:t,uploadDate:a,duration:i,isVerified:m=!1,isLoading:y=!1,onVideoClick:w,onChannelClick:u})=>{const[d,h]=f.useState(!0),b=k(),S=I(),H=W();return y?e.jsxs(g,{w:"100%",minH:{base:"120px",md:"94px"},bg:"gray.50",borderRadius:"12px",overflow:"hidden",gap:{base:2,md:3},p:2,direction:{base:"column",sm:"row"},children:[e.jsx(p,{w:{base:"100%",sm:"168px"},h:{base:"140px",sm:"94px"},borderRadius:"12px",flexShrink:0}),e.jsxs(n,{align:"start",justify:"start",flex:1,spacing:2,pt:1,children:[e.jsx(x,{noOfLines:2,spacing:1,skeletonHeight:"3",w:"90%"}),e.jsx(x,{noOfLines:1,spacing:1,skeletonHeight:"2",w:"60%"})]})]}):e.jsxs(g,{w:"100%",minH:{base:"120px",md:"94px"},cursor:"pointer",borderRadius:"12px",overflow:"hidden",transition:"all 0.2s ease",_hover:{transform:"scale(1.02)"},gap:{base:2,md:3},p:2,direction:{base:"column",sm:"row"},onClick:w,children:[e.jsxs(c,{position:"relative",w:{base:"100%",sm:"168px"},h:{base:"140px",sm:"94px"},borderRadius:"12px",overflow:"hidden",flexShrink:0,bg:"gray.200",children:[e.jsx(E,{src:r,alt:o,w:"100%",h:"100%",objectFit:"cover",onLoad:()=>h(!1),onError:()=>h(!1),style:{display:d?"none":"block"}}),d&&e.jsx(p,{w:"100%",h:"100%",position:"absolute",top:0,left:0}),i&&e.jsx(c,{position:"absolute",bottom:"4px",right:"4px",bg:"rgba(0, 0, 0, 0.8)",color:"white",px:1,py:.5,borderRadius:"4px",fontSize:"xs",fontWeight:"medium",children:S(i)})]}),e.jsxs(n,{align:"start",justify:"start",flex:1,spacing:1,overflow:"hidden",minW:0,children:[e.jsx(l,{fontSize:{base:"16px",md:"14px"},fontWeight:"500",color:"white",lineHeight:"20px",noOfLines:{base:3,md:2},cursor:"pointer",transition:"color 0.2s ease",wordBreak:"break-word",children:o}),e.jsxs(n,{align:"start",spacing:.5,w:"100%",children:[e.jsxs(O,{spacing:1,flexWrap:"wrap",children:[e.jsx(l,{fontSize:{base:"14px",md:"13px"},color:"#aaaaaa",cursor:"pointer",transition:"color 0.2s ease",onClick:j=>{j.stopPropagation(),u?.()},noOfLines:1,children:s}),m&&e.jsx(c,{w:"14px",h:"14px",bg:"gray.500",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"white",flexShrink:0,children:"✓"})]}),e.jsxs(l,{fontSize:{base:"14px",md:"13px"},color:"#aaaaaa",noOfLines:1,wordBreak:"break-word",children:[b(t)," • ",H(a)]})]})]})]})},D=async r=>{try{const o=await fetch(`/data/videos/${r}.json`);if(!o.ok)throw new Error(`Failed to fetch video ${r}`);return await o.json()}catch(o){return console.error(`Error fetching video ${r}:`,o),null}},V=r=>{try{if(localStorage.getItem("historyPaused")==="true")return;const s=localStorage.getItem("watchHistory");let t=[];s&&(t=JSON.parse(s));const a={videoId:r,watchedAt:new Date().toISOString()};t=t.filter(i=>i.videoId!==r),t.push(a),t.length>1e3&&(t=t.slice(-1e3)),localStorage.setItem("watchHistory",JSON.stringify(t))}catch(o){console.error("Error adding to watch history:",o)}},P=()=>{try{const r=localStorage.getItem("watchHistory");return r?JSON.parse(r):[]}catch(r){return console.error("Error loading watch history:",r),[]}},z=async()=>{try{const o=P().reverse();return(await Promise.all(o.map(async t=>{const a=await D(t.videoId);return{...t,videoDetails:a}}))).filter(t=>t.videoDetails!==null)}catch(r){return console.error("Error loading watch history with details:",r),[]}},B=()=>{try{localStorage.removeItem("watchHistory")}catch(r){console.error("Error clearing watch history:",r)}},J=(r,o)=>{try{const s=localStorage.getItem("watchHistory");if(s){let t=JSON.parse(s);t=t.filter(a=>!(a.videoId===r&&a.watchedAt===o)),localStorage.setItem("watchHistory",JSON.stringify(t))}}catch(s){console.error("Error removing from watch history:",s)}},N=()=>localStorage.getItem("historyPaused")==="true",A=r=>{localStorage.setItem("historyPaused",r.toString())};export{O as H,T as M,V as a,B as c,z as g,N as i,J as r,A as s};
