import{r as s,u as A,j as n,B as j}from"./index-DVXXM6oO.js";import{V as x}from"./VideoCard-LOU0JywA.js";import{l as D}from"./videoDataLoader-BZaTkg2Q.js";import{S as M}from"./formatters-DnYoOpiC.js";import{S as v}from"./simple-grid-DPQHptrj.js";import"./skeleton-BkAdXBqt.js";function _(){const[d,V]=s.useState(!0),[a,g]=s.useState(!1),[l,u]=s.useState([]),[C,r]=s.useState([]),[f,S]=s.useState(1),p=s.useRef(null),E=A(),h=10;s.useEffect(()=>{(async()=>{try{const o=await D();if(o&&Array.isArray(o)){u(o);const t=o.slice(0,h);r(t)}else console.error("Invalid data format received"),u([]),r([])}catch(o){console.error("Error fetching video data:",o),u([]),r([])}finally{V(!1)}})()},[]);const w=()=>{a||l.length===0||(g(!0),setTimeout(()=>{const e=f*h%l.length,o=[];for(let t=0;t<h;t++){const i=(e+t)%l.length,c=l[i],m={...c,id:`${c.id}-page-${f}-${t}`};o.push(m)}r(t=>[...t,...o]),S(t=>t+1),g(!1)},2e3))};s.useEffect(()=>{const e=p.current;if(!e||d||l.length===0)return;const o=()=>{if(a)return;const{scrollTop:c,scrollHeight:m,clientHeight:k}=e;c+k>=m-100&&w()};let t=null;const i=()=>{t||(t=setTimeout(()=>{o(),t=null},200))};return e.addEventListener("scroll",i,{passive:!0}),()=>{e.removeEventListener("scroll",i),t&&clearTimeout(t)}},[d,a,l.length,f]);const y=e=>{E(`/watch/${e}`)},I=e=>{console.log("Channel clicked:",e)},L=e=>{console.log("More options clicked:",e)};return n.jsx(j,{ref:p,className:"custom-scrollbar",overflowY:"auto",h:"full",w:"full",p:"20px",children:n.jsxs(v,{columns:{base:1,sm:1,md:2,lg:3,xl:4},spacing:"20px",gap:4,w:"full",children:[d?Array.from({length:10},(e,o)=>n.jsx(x,{isLoading:!0},`loading-${o}`)):C.map(e=>n.jsx(x,{thumbnail:e.thumbnail,title:e.title,channelName:e.channelName,channelAvatar:e.channelAvatar,views:e.views,uploadDate:e.uploadDate,duration:e.duration,isVerified:e.isVerified,onVideoClick:()=>y(e.id),onChannelClick:()=>I(e.channelName),onMoreClick:()=>L(e.id)},e.id)),a&&n.jsx(M,{gridColumn:"1 / -1",text:"Loading more videos...",textColor:"gray.600"})]})})}export{_ as default};
