import{r as c,u as D,j as t,B as s,V as h,a as p,c as W,p as C,T as g,F as k}from"./index-CDy_V-20.js";import{b as P,S as z}from"./formatters-1D1gjGA3.js";import{i as A,H as F,M as R,g as V,c as B,s as E,r as I}from"./watchHistory-hozfT-pw.js";import{H as L}from"./heading-DNVwJvTQ.js";import"./skeleton-MgGYAvlR.js";const T=()=>t.jsxs(s,{width:"16px",height:"16px",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",children:[t.jsx(s,{position:"absolute",width:"12px",height:"2px",bg:"white",transform:"rotate(45deg)"}),t.jsx(s,{position:"absolute",width:"12px",height:"2px",bg:"white",transform:"rotate(-45deg)"})]});function K(){const[d,l]=c.useState([]),[y,x]=c.useState(!0),[u,f]=c.useState(!1),b=D(),m=P();c.useEffect(()=>{(async()=>{try{x(!0);const r=await V();l(r)}catch(r){console.error("Error loading watch history:",r),l([])}finally{x(!1)}})(),f(A())},[]);const w=e=>{b(`/watch/${e}`)},j=()=>{B(),l([])},v=()=>{const e=!u;f(e),E(e)},H=(e,r)=>{I(e,r);const a=d.filter(i=>!(i.videoId===e&&i.watchedAt===r));l(a)},S=(()=>{const e={};return d.forEach(r=>{const a=new Date(r.watchedAt),i=new Date,o=new Date(i);o.setDate(o.getDate()-1);let n;a.toDateString()===i.toDateString()?n="Today":a.toDateString()===o.toDateString()?n="Yesterday":n=a.toLocaleDateString("en-US",{month:"long",day:"numeric",year:a.getFullYear()!==i.getFullYear()?"numeric":void 0}),e[n]||(e[n]=[]),e[n].push(r)}),e})();return t.jsxs(s,{h:"full",w:"full",overflowY:"auto",p:"20px",maxW:"1200px",mx:"auto",children:[t.jsxs(h,{align:"start",spacing:"20px",mb:"30px",children:[t.jsx(L,{as:"h1",size:"2xl",color:"white",fontSize:{base:"28px",md:"36px"},fontWeight:"400",children:"Watch history"}),t.jsxs(F,{spacing:"12px",children:[t.jsx(p,{leftIcon:t.jsx("img",{src:W,alt:"Clear",style:{width:"20px",height:"20px"}}),variant:"ghost",color:"white",fontSize:"14px",fontWeight:"400",bg:"rgba(255, 255, 255, 0.08)",_hover:{bg:"rgba(255, 255, 255, 0.15)"},onClick:j,children:"Clear all watch history"}),t.jsx(p,{leftIcon:t.jsx("img",{src:C,alt:"Pause",style:{width:"20px",height:"20px"}}),variant:"ghost",color:"white",fontSize:"14px",fontWeight:"400",bg:"rgba(255, 255, 255, 0.08)",_hover:{bg:"rgba(255, 255, 255, 0.15)"},onClick:v,children:u?"Resume watch history":"Pause watch history"})]})]}),y?t.jsx(z,{text:"Loading watch history...",textColor:"gray.400",color:"red.500",minHeight:"30vh"}):d.length===0?t.jsx(s,{textAlign:"center",py:"60px",children:t.jsx(g,{color:"gray.400",fontSize:"16px",children:"No watch history yet"})}):t.jsx(h,{align:"start",spacing:"24px",children:Object.entries(S).map(([e,r])=>t.jsxs(s,{w:"full",children:[t.jsx(g,{color:"white",fontSize:"18px",fontWeight:"600",mb:"20px",bg:"rgba(255, 255, 255, 0.05)",px:"12px",py:"6px",borderRadius:"8px",display:"inline-block",children:e}),t.jsx(h,{align:"start",spacing:"16px",pl:"0",children:r.map((a,i)=>{const o=a.videoDetails;return o?t.jsx(s,{w:"full",position:"relative",bg:"rgba(255, 255, 255, 0.02)",borderRadius:"12px",p:"12px",border:"1px solid rgba(255, 255, 255, 0.05)",_hover:{bg:"rgba(255, 255, 255, 0.06)",borderColor:"rgba(255, 255, 255, 0.1)"},transition:"all 0.2s ease",children:t.jsxs(s,{position:"relative",children:[t.jsxs(k,{gap:"16px",align:"start",children:[t.jsx(s,{flex:"1",transform:"scale(1.1)",transformOrigin:"left top",children:t.jsx(R,{thumbnail:o.thumbnail,title:o.title,channelName:o.channelName,views:o.views,uploadDate:o.uploadDate,duration:o.duration,isVerified:o.isVerified,onVideoClick:()=>w(a.videoId),onChannelClick:()=>{}})}),t.jsx(s,{flexShrink:0,pt:"8px",children:t.jsx(p,{"aria-label":"Remove from history",variant:"ghost",color:"white",size:"sm",bg:"rgba(255, 255, 255, 0.15)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"50%",w:"32px",h:"32px",minW:"32px",display:"flex",alignItems:"center",justifyContent:"center",p:0,_hover:{bg:"rgba(255, 0, 0, 0.4)",borderColor:"red.400",transform:"scale(1.1)"},transition:"all 0.2s ease",onClick:n=>{n.stopPropagation(),H(a.videoId,a.watchedAt)},children:t.jsx(T,{})})})]}),t.jsx(s,{position:"absolute",bottom:"0",right:"0",bg:"rgba(0, 0, 0, 0.8)",px:"8px",py:"4px",borderRadius:"6px",border:"1px solid rgba(255, 255, 255, 0.1)",children:t.jsxs(g,{color:"gray.300",fontSize:"11px",fontWeight:"500",whiteSpace:"nowrap",children:["Watched ",m(a.watchedAt)]})})]})},`${a.videoId}-${a.watchedAt}-${i}`):null})})]},e))})]})}export{K as default};
